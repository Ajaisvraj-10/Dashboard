{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-4e64916a\"],{\"9a0f\":function(t,e,s){\"use strict\";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{staticClass:\"main-content main-content2\"},[s(\"div\",[s(\"div\",{staticClass:\"d-flex mb-2 align-items-center justify-content-between\"},[t._t(\"header\",[s(\"h5\",{staticClass:\"mb-0\"},[t._v(\"Farm \"),s(\"span\",{staticClass:\"text-success\"},[t._v(\"/\"+t._s(t.farm_data.name)+\" \")])])]),s(\"div\",{staticClass:\"d-flex\"},[s(\"b-button\",{staticClass:\" px-3 py-1  d-sm-block mx-1\",attrs:{variant:\"success\"},on:{click:function(e){return t.createPlant()}}},[t._v(\" + Add Plant \")]),s(\"router-link\",{attrs:{to:\"/app/procurement/farms\"}},[s(\"b-button\",{staticClass:\" px-3 py-1  d-sm-block mx-1\",attrs:{variant:\"danger\"}},[t._v(\" Discard \")])],1)],1)],2),s(\"div\",{staticClass:\"my-3 border-top\"})]),s(\"div\",{staticClass:\" pt-1\"},[s(\"div\",{staticClass:\"row mx-0\"},[s(\"div\",{staticClass:\"col-md-9 p-1\"},[s(\"div\",{staticClass:\"row mx-0\",staticStyle:{height:\"70vh\",\"overflow-y\":\"auto\"}},t._l(t.farm_data.plants,(function(e){return s(\"div\",{staticClass:\"col-md-3 p-1\"},[s(\"div\",{staticClass:\"card text-center\",staticStyle:{\"min-height\":\"140px\"}},[s(\"div\",{staticClass:\"mb-1\"},[s(\"div\",{staticClass:\"card p-2 m-0 flex-row border\"},[t._m(0,!0),s(\"div\",{staticClass:\"col-md-10\"},[t._v(\" Plant :\"),s(\"b\",[t._v(t._s(e.plant_details.name))])])])])])])})),0)]),s(\"div\",{staticClass:\"col-md-3 p-1\"},[s(\"div\",{staticClass:\"card\"},[s(\"div\",{staticClass:\"card p-2 m-0 flex-row border\"},[t._m(1),s(\"div\",{staticClass:\"col-md-10 align-self-center\"},[s(\"b\",[t._v(t._s(t.plant_data.name)+\" \")]),s(\"div\",[s(\"b-button\",{staticClass:\" px-1 py-0\",staticStyle:{\"font-size\":\"12px\"},attrs:{type:\"button\",variant:\"primary\"},on:{click:function(e){return t.startExpense()}}},[t._v(\"Add Expense\")])],1)])]),s(\"div\",{staticClass:\"process_kanban\"},[t._l(t.expenses,(function(e,r){return s(\"div\",{staticClass:\"m-1\"},[s(\"div\",{staticClass:\"card px-3 py-2 cursor-pointer\",class:r%2==0?\"bg-lightgreen\":\"bg-lightred\"},[s(\"table\",[s(\"tr\",[s(\"th\",{staticClass:\"text-primary\"},[t._v(\"#\"+t._s(e.id))]),s(\"th\",{staticClass:\"text-right\",attrs:{colspan:\"2\"}},[t._v(\" \"+t._s(t.dateFormate(e.created_on))+\" \")])]),s(\"tr\",[s(\"th\",[t._v(\"Status\")]),s(\"th\",{staticClass:\"text-right\",attrs:{colspan:\"2\"}},[s(\"span\",{staticClass:\"text-success\"},[t._v(t._s(e.status))])])]),s(\"tr\",[s(\"th\",[t._v(\" Workers \")]),s(\"th\",[t._v(\" \"+t._s(e.workers.length>0?e.workers.length+\" worker\"+t.checkMult(e.workers.length):\"No workers\")+\" \")]),s(\"th\",{staticClass:\"text-right\"},[e.workers.length>0?s(\"span\",{staticClass:\"badge badge-warning cursor-pointer\",on:{click:function(s){return t.startProcess(\"workers\",e,!0)}}},[t._v(\"View\")]):s(\"span\",{staticClass:\"badge badge-primary cursor-pointer\",on:{click:function(s){return t.startProcess(\"workers\",e)}}},[t._v(\"Add\")])])]),s(\"tr\",[s(\"th\",[t._v(\" Expenses \")]),s(\"th\",[t._v(\" \"+t._s(e.total_expense>0?\"Rs\"+e.total_expense:\"No expenses\")+\" \")]),s(\"th\",{staticClass:\"text-right\"},[e.total_expense>0?s(\"span\",{staticClass:\"badge badge-warning cursor-pointer\",on:{click:function(s){return t.startProcess(\"expenses\",e,!0)}}},[t._v(\"View\")]):s(\"span\",{staticClass:\"badge badge-primary cursor-pointer\",on:{click:function(s){return t.startProcess(\"expenses\",e)}}},[t._v(\"Add\")])])])])]),s(\"hr\",{staticClass:\"my-2\"})])})),s(\"div\",{staticClass:\"text-center\"})],2)])])])]),t._e()])},a=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{staticClass:\"card col-md-2 align-self-center p-0\"},[s(\"img\",{staticStyle:{\"vertical-align\":\"top\"},attrs:{src:\"/img/website.png\"}})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{staticClass:\"card col-md-2 align-self-center p-1\"},[s(\"img\",{staticStyle:{\"vertical-align\":\"top\"},attrs:{src:\"/img/website.png\"}})])}],n=(s(\"4160\"),s(\"d3b7\"),s(\"159b\"),s(\"4dbf\")),o={metaInfo:{title:\"FPO - ICS\"},components:{ProductFields:n[\"a\"]},data:function(){return{farm_data:{id:null,plants:[]},plant_data:{id:null},is_view:!1,action:\"create\",workers:[],expenses:[]}},mounted:function(){this.$root.current_section=\"procurement\",this.farm_data.id=this.$route.params.id,this.getForm(),this.getWorkers()},methods:{getForm:function(){var t=this,e=new Headers;e.append(\"Authorization\",\"Token \"+this.$root.token),fetch(this.api_url+\"/product/farms/\"+this.farm_data.id+\"/\",{method:\"get\",headers:e}).then((function(t){return t.json()})).then((function(e){t.farm_data=e}))},plantFormData:function(){var t=this,e=new FormData(this.$refs[\"plantFormData\"]);e.append(\"user\",this.userId);var s=new Headers;s.append(\"Authorization\",\"Token \"+this.$root.token),fetch(this.api_url+\"/product/farm_plants/\",{method:\"POST\",body:e,headers:s}).then((function(t){return t.json()})).then((function(e){e.id>0?(t.spread_product=e,t.yardAddSheets()):t.showAlert(\"Something Wrong!\")}))},yardAddSheets:function(){var t=this,e=new FormData;e.append(\"yard\",this.yard.id),e.append(\"yard_spread_product\",this.spread_product.id);var s=new Headers;s.append(\"Authorization\",\"Token \"+this.$root.token),fetch(this.api_url+\"/production/yard_sheets/\",{method:\"POST\",body:e,headers:s}).then((function(t){return t.json()})).then((function(e){e.id>0?(t.$bvModal.hide(\"create-sheet\"),t.getForm(),t.getSheets(),t.showAlert(\"Saved Successfully!\")):t.showAlert(\"Something Wrong!\")}))},saveSheet:function(){var t=this;this.current_sheet.sheet_number||this.showAlert(\"Please enter sheet number!\");var e=new FormData;e.append(\"yard\",this.current_sheet.yard),e.append(\"yard_spread_product\",this.current_sheet.yard_spread_product),e.append(\"sheet_number\",this.current_sheet.sheet_number),e.append(\"is_active\",1),\"Completed\"==this.current_sheet.status?(e.append(\"status\",\"Completed\"),e.append(\"quantity\",this.current_sheet.quantity)):e.append(\"status\",\"Open\");var s=new Headers;s.append(\"Authorization\",\"Token \"+this.$root.token),fetch(this.api_url+\"/production/yard_sheets/\"+this.current_sheet.id+\"/\",{method:\"PUT\",body:e,headers:s}).then((function(t){return t.json()})).then((function(e){e.id>0?(t.getSheets(),t.showAlert(\"Saved Successfully!\"),t.$bvModal.hide(\"sheet-process\")):t.showAlert(\"Something Wrong!\")}))},getYardProducts:function(){var t=this,e=new Headers;e.append(\"Authorization\",\"Token \"+this.$root.token),fetch(this.api_url+\"/production/transfer_yard_products/?yard=\"+this.yard.id,{method:\"get\",headers:e}).then((function(t){return t.json()})).then((function(e){t.yard_products=e}))},getSheets:function(){var t=this,e=new Headers;e.append(\"Authorization\",\"Token \"+this.$root.token),fetch(this.api_url+\"/production/yard_sheets/?yard_spread_product=\"+this.spread_product.id,{method:\"get\",headers:e}).then((function(t){return t.json()})).then((function(e){t.current_sheet={},t.sheets=e}))},startSheetProcess:function(t,e){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{id:null},r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.action=t,this.current_sheet=e,this.sheet_process=s,this.is_view=r;var a=\"\";if(e.sheet_processes.forEach((function(t){t.close_time||s.id||(a=\"Please close your sheet!\")})),a)return this.showAlert(a),!1;this.$bvModal.show(\"sheet-process\")},dataSheetProcessForm:function(){\"stop\"==this.action?(this.current_sheet.status=\"Completed\",this.saveSheet()):this.sheetProcessForm()},sheetProcessForm:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"POST\";if(\"supervisor\"!=this.$root.user_type)return this.showAlert(\"You cannot add!\"),!1;var s=\"\";this.sheet_process.id&&(e=\"PUT\",s=this.sheet_process.id+\"/\");var r=new FormData(this.$refs[\"sheetProcessForm\"]);r.append(\"supervisor\",this.employeeId),r.append(\"yard_process\",this.sheet_process.yard_process),r.append(\"sheet\",this.sheet_process.sheet);var a=new Headers;a.append(\"Authorization\",\"Token \"+this.$root.token),fetch(this.api_url+\"/production/yard_process_sheet/\"+s,{method:e,body:r,headers:a}).then((function(t){return t.json()})).then((function(e){e.id>0?(t.sheet_process.id=e.id,t.$bvModal.hide(\"sheet-process\"),t.getSheets(),t.showAlert(\"Saved Successfully!\")):t.showAlert(\"Something Wrong!\")}))},dataForm:function(){this.form_data.status=\"Starting\",(this.form_data.workers.length>0||this.form_data.total_expense>0)&&(this.form_data.status=\"Completed\"),this.yardProcessForm()},yardProcessForm:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"POST\";if(\"supervisor\"!=this.$root.user_type)return this.showAlert(\"You cannot add!\"),!1;var s=\"\";this.form_data.id&&(e=\"PUT\",s=this.form_data.id+\"/\");var r=new FormData(this.$refs[\"dataForm\"]);r.append(\"supervisor\",this.employeeId),r.append(\"status\",this.form_data.status),r.append(\"yard_process\",this.form_data.id);var a=new Headers;a.append(\"Authorization\",\"Token \"+this.$root.token),fetch(this.api_url+\"/production/yard_process/\"+s,{method:e,body:r,headers:a}).then((function(t){return t.json()})).then((function(e){e.id>0?(t.form_data.id=e.id,t.$bvModal.hide(\"start-process\"),t.getForm(),t.showAlert(\"Saved Successfully!\")):t.showAlert(\"Something Wrong!\")}))},getWorkers:function(){var t=this,e=new Headers;e.append(\"Authorization\",\"Token \"+this.$root.token),fetch(this.api_url+\"/employee/workers/\",{method:\"get\",headers:e}).then((function(t){return t.json()})).then((function(e){t.workers=e}))}}},i=o,d=(s(\"cb85\"),s(\"2877\")),c=Object(d[\"a\"])(i,r,a,!1,null,null,null);e[\"default\"]=c.exports},cb85:function(t,e,s){\"use strict\";var r=s(\"ec43\"),a=s.n(r);a.a},ec43:function(t,e,s){}}]);","extractedComments":[]}