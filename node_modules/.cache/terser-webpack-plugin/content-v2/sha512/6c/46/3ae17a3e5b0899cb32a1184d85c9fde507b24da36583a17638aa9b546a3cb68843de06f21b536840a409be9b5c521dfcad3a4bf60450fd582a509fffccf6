{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-59c00a39\"],{4336:function(t,e,a){},\"4bc9\":function(t,e,a){\"use strict\";var i=a(\"4336\"),r=a.n(i);r.a},efa2:function(t,e,a){\"use strict\";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a(\"div\",{staticClass:\"main-content\"},[a(\"main\",[a(\"div\",{staticClass:\"header-bio\"},[a(\"div\",{staticClass:\"container d-flex align-items-center px-4 \"},[a(\"img\",{attrs:{src:\"/images/left-arrow.png\",width:\"10\"},on:{click:function(e){return t.goBack()}}}),a(\"h4\",{staticClass:\"font-weight-700 px-3\"},[t._v(\" Farmer Location\")])])]),t.not_start?a(\"div\",{},[a(\"div\",{staticClass:\"loading\",staticStyle:{\"z-index\":\"999999999999999\"}})]):t._e(),a(\"form\",{ref:\"dataForm\",style:t.not_start?\"opacity:0.5\":\"\",on:{submit:function(e){return e.preventDefault(),t.dataForm()}}},[a(\"div\",{staticClass:\"body-bio2 px-4 py-2 create\",staticStyle:{height:\"calc(100vh - 135px)\",overflow:\"auto\"}},[a(\"div\",{},[a(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:!t.$route.query.farmer&&-2==t.input_col,expression:\"!$route.query.farmer && input_col==-2\"}]},[a(\"h4\",{staticClass:\"text-light pr-4 py-2\"},[t._v(\" ICS: \")]),a(\"div\",{staticClass:\"inspection-btn\"},[t._l(t.all_ics,(function(e,i){return a(\"button\",{staticClass:\"btn\",class:t.filter.ics==e.id?\"active-btn\":\"\",attrs:{type:\"button\"},on:{click:function(a){t.filter.ics=e.id,t.nextCol(),t.changeICS()}}},[t._v(t._s(e.name))])})),a(\"input\",{directives:[{name:\"model\",rawName:\"v-model\",value:t.filter.ics,expression:\"filter.ics\"}],class:\"check_field_-2\",attrs:{type:\"hidden\",required:\"\"},domProps:{value:t.filter.ics},on:{input:function(e){e.target.composing||t.$set(t.filter,\"ics\",e.target.value)}}})],2)]),a(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:!t.$route.query.farmer&&-1==t.input_col,expression:\"!$route.query.farmer && input_col==-1\"}]},[a(\"h4\",{staticClass:\"text-light pr-4 py-2\"},[t._v(\" VFC: \")]),a(\"div\",{staticClass:\"inspection-btn\"},[t._l(t.all_vfc,(function(e,i){return a(\"button\",{staticClass:\"btn\",class:t.filter.vfc==e.id?\"active-btn\":\"\",attrs:{type:\"button\"},on:{click:function(a){t.filter.vfc=e.id,t.nextCol(),t.searchFarmers()}}},[t._v(t._s(e.name))])})),a(\"input\",{directives:[{name:\"model\",rawName:\"v-model\",value:t.filter.vfc,expression:\"filter.vfc\"}],class:\"check_field_-1\",attrs:{type:\"hidden\",required:\"\"},domProps:{value:t.filter.vfc},on:{input:function(e){e.target.composing||t.$set(t.filter,\"vfc\",e.target.value)}}})],2)]),a(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:!t.$route.query.farmer&&0==t.input_col,expression:\"!$route.query.farmer && input_col==0\"}]},[a(\"h4\",{staticClass:\"text-light pr-4 py-2\"},[t._v(\" Farmers: \")]),a(\"div\",{staticClass:\"inspection-btn\"},[t._l(t.farmers,(function(e,i){return a(\"button\",{staticClass:\"btn\",class:t.form_data.farmer==e.id?\"active-btn\":\"\",attrs:{type:\"button\"},on:{click:function(a){t.selectFarmer(e),t.nextCol()}}},[t._v(t._s(e.farmer_code)+\"-\"+t._s(e.name)+\" \")])})),a(\"input\",{directives:[{name:\"model\",rawName:\"v-model\",value:t.form_data.farmer,expression:\"form_data.farmer\"}],class:\"check_field_0\",attrs:{type:\"hidden\",required:\"\"},domProps:{value:t.form_data.farmer},on:{input:function(e){e.target.composing||t.$set(t.form_data,\"farmer\",e.target.value)}}})],2)]),a(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:1==t.input_col,expression:\"input_col==1\"}]},[a(\"div\",{staticClass:\"o_thread_search_input\"},[a(\"h4\",{staticClass:\"text-light pr-4 py-2\"},[t._v(\" Farmer name: \")]),a(\"input\",{staticClass:\"form-control\",attrs:{type:\"text\",placeholder:\"Farmer name\",autocomplete:\"off\",readonly:\"\",required:\"\"},domProps:{value:t.form_data.farmer_detail.name}}),a(\"input\",{class:\"check_field_1\",attrs:{type:\"hidden\",name:\"farmer\",required:\"\"},domProps:{value:t.form_data.farmer}})])]),a(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:t.input_col>0,expression:\"input_col>0\"}]},[a(\"h4\",{staticClass:\"text-light pr-4 py-2\"},[t._v(\" Farmer location: \")]),a(\"div\",{attrs:{id:\"map\"}})]),a(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:2==t.input_col,expression:\"input_col==2\"}]},[a(\"div\",{staticClass:\"d-flex justify-content-between mt-2\"},[a(\"h2\",{staticClass:\"text-light pr-4 py-2\"},[t._v(\"Distance:\")]),a(\"h2\",{staticClass:\"py-2 text-right \"},[t._v(t._s(t.distance))])]),a(\"div\",{staticClass:\"mt-3\"},[a(\"button\",{staticClass:\"btn btn-primary btn-lg btn-block text-18 font-weight-700  \",attrs:{type:\"button\"},on:{click:function(e){return t.selectLocation()}}},[t._v(\"Use Current Location\")])])])])]),a(\"div\",{staticClass:\" my-1 footer border-top\"},[0==t.not_start?a(\"div\",{staticClass:\"px-4\"},[a(\"div\",{staticStyle:{display:\"flex\",\"justify-content\":\"flex-end\",gap:\"10px\"}},[a(\"button\",{staticClass:\"btn btn-light\",attrs:{type:\"button\"},on:{click:function(e){t.input_col>-2&&t.backCol()}}},[a(\"i\",{staticClass:\"fa fa-angle-left\"}),t._v(\" Back\")]),t.select_location?a(\"button\",{staticClass:\"btn btn-secondary\",attrs:{type:\"button\"},on:{click:function(e){return t.dataForm()}}},[t._v(\"Save \"),a(\"i\",{staticClass:\"fa fa-angle-right\",staticStyle:{color:\"white\"}})]):a(\"button\",{staticClass:\"btn btn-secondary\",attrs:{type:\"button\"},on:{click:function(e){return t.nextCol()}}},[t._v(t._s(1==t.input_col?\"Check Location\":2==t.input_col?\"No Changes\":\"Next\")+\" \"),a(\"i\",{staticClass:\"fa fa-angle-right\",staticStyle:{color:\"white\"}})])])]):t._e()]),a(\"b-modal\",{attrs:{id:\"confirmPopup\",title:\"Alert\",\"hide-footer\":\"\"}},[a(\"div\",{staticClass:\"modal-body p-0 m-0\"},[a(\"div\",{staticClass:\"row mx-0 mb-3\"},[a(\"div\",{staticClass:\"col-md-12\"},[t._v(\" Are you sure want to this action? \")])])]),a(\"div\",{staticClass:\"modal-footer\"},[0==t.not_start?a(\"button\",{staticClass:\"btn btn-success px-4\",attrs:{type:\"button\"},on:{click:function(e){return t.dataForm(\"yes\")}}},[t._v(\"Yes\")]):t._e(),a(\"button\",{staticClass:\"btn  px-4\",attrs:{type:\"button\"},on:{click:function(e){return t.$bvModal.hide(\"confirmPopup\")}}},[t._v(\"No\")])])])],1)])])},r=[],o=(a(\"4de4\"),a(\"caad\"),a(\"a15b\"),a(\"d81d\"),a(\"fb6a\"),a(\"b680\"),a(\"d3b7\"),a(\"2532\"),{metaInfo:{title:\"FPO - LOCATION\"},components:{},data:function(){return{form_data:{purchase_type:1,date:new Date,estimate_qty:0,farmer_estimate:0,farmer_detail:{name:\"\",farmer_code:\"\"},farmer:null,available_qty:0,qc_status:\"Waiting\"},filter:{ics:null,panchayath:null,vfc:null,count:0},id:null,input_col:-2,action:\"create\",farmers:[],map:null,marker:[],latitude:null,longitude:null,current_latitude:null,current_longitude:null,distance:0,not_start:!0,select_location:!1,lock_btn:!1}},mounted:function(){this.form_data.date=this.currentDate(),this.action=this.$route.params.action,this.$route.query.farmer&&(this.input_col=1,this.form_data.farmer=this.$route.query.farmer,this.getFarmer()),\"edit\"==this.action?(this.id=this.$route.params.id,this.getForm()):(this.not_start=!1,this.getIcs())},watch:{$route:\"changeURL\"},methods:{changeURL:function(){this.form_data.date=this.currentDate(),this.action=this.$route.params.action,this.getPurchaseTypes(),this.$route.query.farmer&&(this.form_data.farmer=this.$route.query.farmer,this.getFarmer()),\"edit\"==this.action?(this.id=this.$route.params.id,this.getForm()):this.not_start=!1},nextCol:function(){var t=this;if(this.lock_btn)return!1;this.lock_btn=!0,setTimeout((function(){t.lock_btn=!1;for(var e=document.getElementsByClassName(\"check_field_\"+t.input_col),a=!0,i=0;i<e.length;i++)e[i].style.border=\"none\",\"\"==e[i].value&&(e[i].style.border=\"1px red solid\",a=!1);a?(t.input_col++,1==t.input_col?t.activatePlacesSearch():2==t.input_col?t.currentLocation():3==t.input_col&&t.goBack()):t.showAlert(\"Please select a farmer!\")}),300)},backCol:function(){this.select_location=!1,this.input_col--,0==this.input_col&&this.$route.query.farmer&&(this.input_col=1)},getFarmer:function(){var t=this,e=new Headers;e.append(\"Authorization\",\"Bearer \"+this.$root.token),fetch(this.api_url+\"/fpo/farmers/\"+this.form_data.farmer+\"/\",{method:\"get\",headers:e}).then((function(t){return t.json()})).then((function(e){t.selectFarmer(e)}))},searchFarmers:function(){var t=this,e=new Headers,a=new FormData;a.append(\"vfc\",this.filter.vfc),a.append(\"search_type\",\"sample_procurement\"),e.append(\"Authorization\",\"Bearer \"+this.$root.token),fetch(this.api_url+\"/fpo/search_farmers/\",{method:\"post\",headers:e,body:a}).then((function(t){return t.json()})).then((function(e){t.farmers=e}))},selectFarmer:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t&&(this.form_data.farmer_detail=t,t.status?this.form_data.status=t.status:this.form_data.status=\"NEW\",this.form_data.farmer=t.id,this.$route.query.farmer&&this.activatePlacesSearch())},activatePlacesSearch:function(){var t=11.80239,e=76.003883;this.form_data.farmer_detail&&(t=this.form_data.farmer_detail.latitude.includes(\".\")?this.form_data.farmer_detail.latitude:[this.form_data.farmer_detail.latitude.slice(0,2),\".\",this.form_data.farmer_detail.latitude.slice(2)].join(\"\"),e=this.form_data.farmer_detail.longitude.includes(\".\")?this.form_data.farmer_detail.longitude:[this.form_data.farmer_detail.longitude.slice(0,2),\".\",this.form_data.farmer_detail.longitude.slice(2)].join(\"\")),this.latitude=parseFloat(t),this.longitude=parseFloat(e);var a=new window.google.maps.LatLng(t,e),i=document.getElementById(\"map\");this.map=new window.google.maps.Map(i,{zoom:13,center:a});var r=\"Farmer Location\",o=new window.google.maps.LatLng(t,e),n=this;this.marker[0]=new window.google.maps.Marker({position:o,map:n.map,title:r,icon:\"/images/farmer-marker.png\"})},currentLocation:function(){var t=this;navigator.geolocation?navigator.geolocation.getCurrentPosition((function(e){var a=new window.google.maps.LatLng(e.coords.latitude,e.coords.longitude);t.marker[1]=new window.google.maps.Marker({position:a,map:t.map,title:\"Current Location\",icon:\"/images/live_location.gif\"}),t.current_latitude=e.coords.latitude,t.current_longitude=e.coords.longitude;var i=[{lat:t.latitude,lng:t.longitude},{lat:e.coords.latitude,lng:e.coords.longitude}],r=new google.maps.Polyline({path:i,geodesic:!0,strokeColor:\"#FF0000\",strokeOpacity:1,strokeWeight:2});r.setMap(t.map),t.distance=t.calcCrow(t.latitude,t.longitude,e.coords.latitude,e.coords.longitude),t.distance<1?t.distance=parseFloat(1e3*t.distance).toFixed(2)+\"m\":t.distance=parseFloat(t.distance).toFixed(2)+\"km\"})):this.showAlert(\"Please check GPS!\")},selectLocation:function(){var t=this;this.latitude=t.current_latitude,this.longitude=t.current_longitude;var e=new window.google.maps.LatLng(t.current_latitude,t.current_longitude),a=document.getElementById(\"map\");this.map=new window.google.maps.Map(a,{zoom:13,center:e});var i=\"Farmer Location\",r=new window.google.maps.LatLng(t.current_latitude,t.current_longitude);this.marker[0]=new window.google.maps.Marker({position:r,map:t.map,title:i,icon:\"/images/farmer-marker.png\"}),this.distance=\"0.00m\",this.select_location=!0},calcCrow:function(t,e,a,i){function r(t){return t*Math.PI/180}var o=6371,n=r(a-t),s=r(i-e),c=(t=r(t),a=r(a),Math.sin(n/2)*Math.sin(n/2)+Math.sin(s/2)*Math.sin(s/2)*Math.cos(t)*Math.cos(a)),l=2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),u=o*l;return u},dataForm:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"no\";if(\"no\"==t)return this.$bvModal.show(\"confirmPopup\"),!1;this.$bvModal.hide(\"confirmPopup\"),this.not_start=!0,this.updateFarmerLocation()},updateFarmerLocation:function(){var t=this,e=new FormData(this.$refs[\"dataForm\"]);e.append(\"latitude\",this.latitude),e.append(\"longitude\",this.longitude);var a=new Headers;a.append(\"Authorization\",\"Bearer \"+this.$root.token),fetch(this.api_url+\"/fpo/update_farmer_location/\",{method:\"POST\",body:e,headers:a}).then((function(t){return t.json()})).then((function(e){e.success?(t.showAlert(\"Saved Successfully!\"),t.goBack()):t.showAlert(\"Something Wrong!\")}))}}}),n=o,s=(a(\"4bc9\"),a(\"2877\")),c=Object(s[\"a\"])(n,i,r,!1,null,\"55e8af09\",null);e[\"default\"]=c.exports}}]);","extractedComments":[]}