{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-92e3cf20\"],{\"415e\":function(t,a,e){},\"970c\":function(t,a,e){\"use strict\";var r=e(\"415e\"),o=e.n(r);o.a},face:function(t,a,e){\"use strict\";e.r(a);var r=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e(\"div\",{staticClass:\"main-content create-main\"},[e(\"form\",{ref:\"dataForm\",on:{submit:function(a){return a.preventDefault(),t.dataForm()}}},[e(\"div\",[e(\"div\",{staticClass:\"d-flex mb-2 align-items-center  justify-content-between\"},[t._t(\"header\",[e(\"h5\",{staticClass:\"mb-0\"},[e(\"span\",{staticClass:\"text-success\"},[t._v(\"Farmer Purchase Request\")]),t._v(\" / \"+t._s(t.slugToWord(t.action)))])]),e(\"div\",{staticClass:\"d-flex\"},[e(\"b-button\",{staticClass:\" px-3 py-1  d-sm-block mx-1\",attrs:{variant:\"success\",type:\"submit\"}},[t._v(\"Save \")]),e(\"router-link\",{attrs:{to:\"/app/purchase-manager/farmer-purchase-request\"}},[e(\"b-button\",{staticClass:\" px-3 py-1  d-sm-block mx-1\",attrs:{variant:\"danger\"}},[t._v(\"Discard \")])],1),e(\"b-dropdown\",{staticClass:\"action-button mx-1\",attrs:{id:\"dropdown-right\",right:\"\",text:\"Action\",variant:\"default\"}},[e(\"b-dropdown-header\",{attrs:{id:\"dropdown-header-label\"}},[e(\"h6\",{staticClass:\"cursor-pointer my-2\"},[t._v(\"Delete\")]),e(\"h6\",{staticClass:\"cursor-pointer my-2\"},[t._v(\"Duplicate\")])])],1)],1)],2),e(\"div\",{staticClass:\" my-3 border-top\"})]),e(\"b-row\",{staticClass:\"main-scroll\"},[e(\"b-col\",{staticClass:\"my-3\",attrs:{lg:\"8\",xl:\"8\"}},[e(\"b-card\",{staticClass:\"card-scroll\",attrs:{\"header-bg-variant\":\"transparent\"}},[e(\"div\",[e(\"h5\",[t._v(\"Farmers\")]),e(\"div\",{staticClass:\"ul-contact-detail__timeline\"},[e(\"div\",{staticClass:\"row\"},[e(\"div\",{staticClass:\"o_thread_composer  \"},[e(\"div\",{staticClass:\"o_composer_container my-2 row mx-0\"},[e(\"div\",{staticClass:\" col-md-12\"},[e(\"table\",{staticClass:\"table\"},[e(\"thead\",[e(\"tr\",[e(\"th\",[t._v(\"Farmer Code\")]),e(\"th\",[t._v(\"Name\")]),e(\"th\",[t._v(\"Procure Quantity\")]),e(\"th\",[t._v(\"Cutting \")]),e(\"th\",[t._v(\"Cutting Qc (%)\")]),e(\"th\",[t._v(\"Final Quantity\")]),e(\"th\",[t._v(\"Final Price\")])])]),e(\"tbody\",[t._l(t.farmers,(function(a,r){return e(\"tr\",[e(\"td\",[t._v(\" \"+t._s(a.farmer_detail.farmer_code)+\" \")]),e(\"td\",[t._v(\" \"+t._s(a.farmer_detail.name)+\" \")]),e(\"td\",[e(\"input\",{directives:[{name:\"model\",rawName:\"v-model\",value:a.procure_qty,expression:\"farmer.procure_qty\"}],staticClass:\"ui-autocomplete-input\",attrs:{placeholder:\"Procure Quantity\",type:\"text\",name:\"procure_qty\"+a.id,readonly:\"\"},domProps:{value:a.procure_qty},on:{input:function(e){e.target.composing||t.$set(a,\"procure_qty\",e.target.value)}}})]),e(\"td\",[e(\"input\",{directives:[{name:\"model\",rawName:\"v-model\",value:a.cutting_mngr,expression:\"farmer.cutting_mngr\"}],staticClass:\"ui-autocomplete-input\",attrs:{placeholder:\"Cutting\",type:\"text\",name:\"cutting_mngr\"+a.id,required:\"\"},domProps:{value:a.cutting_mngr},on:{input:[function(e){e.target.composing||t.$set(a,\"cutting_mngr\",e.target.value)},function(a){return t.calcultion(\"cutting\")}]}})]),e(\"td\",[e(\"input\",{directives:[{name:\"model\",rawName:\"v-model\",value:a.cutting,expression:\"farmer.cutting\"}],staticClass:\"ui-autocomplete-input\",attrs:{placeholder:\"Cutting (Qc)\",type:\"text\",name:\"cutting\"+a.id,required:\"\"},domProps:{value:a.cutting},on:{input:[function(e){e.target.composing||t.$set(a,\"cutting\",e.target.value)},function(a){return t.calcultion(\"cutting\")}]}})]),e(\"td\",[e(\"input\",{directives:[{name:\"model\",rawName:\"v-model\",value:a.quantity,expression:\"farmer.quantity\"}],staticClass:\"ui-autocomplete-input\",attrs:{placeholder:\"Final Quantity\",type:\"text\",name:\"quantity\"+a.id,required:\"\"},domProps:{value:a.quantity},on:{input:[function(e){e.target.composing||t.$set(a,\"quantity\",e.target.value)},function(a){return t.calcultion()}]}})]),e(\"td\",[e(\"input\",{directives:[{name:\"model\",rawName:\"v-model\",value:a.price,expression:\"farmer.price\"}],staticClass:\"ui-autocomplete-input\",attrs:{placeholder:\"Price\",type:\"text\",name:\"price\"+a.id,required:\"\"},domProps:{value:a.price},on:{input:[function(e){e.target.composing||t.$set(a,\"price\",e.target.value)},function(a){return t.calcultion(\"price\")}]}})])])})),e(\"tr\",[e(\"th\"),e(\"th\",{staticClass:\"text-right\"},[t._v(\"Total\")]),e(\"th\",[e(\"input\",{directives:[{name:\"model\",rawName:\"v-model\",value:t.form_data.total_procure_qty,expression:\"form_data.total_procure_qty\"}],staticClass:\"ui-autocomplete-input\",attrs:{placeholder:\"Quantity\",type:\"text\",name:\"total_procure_qty\",readonly:\"\"},domProps:{value:t.form_data.total_procure_qty},on:{input:function(a){a.target.composing||t.$set(t.form_data,\"total_procure_qty\",a.target.value)}}})]),e(\"th\",[e(\"input\",{directives:[{name:\"model\",rawName:\"v-model\",value:t.form_data.total_cutting_mngr,expression:\"form_data.total_cutting_mngr\"}],staticClass:\"ui-autocomplete-input\",attrs:{placeholder:\"Cutting\",type:\"text\",name:\"total_cutting_mngr\",readonly:\"\"},domProps:{value:t.form_data.total_cutting_mngr},on:{input:function(a){a.target.composing||t.$set(t.form_data,\"total_cutting_mngr\",a.target.value)}}})]),e(\"th\",[e(\"input\",{directives:[{name:\"model\",rawName:\"v-model\",value:t.form_data.total_cutting,expression:\"form_data.total_cutting\"}],staticClass:\"ui-autocomplete-input\",attrs:{placeholder:\"Cutting (Qc)\",type:\"text\",name:\"total_cutting\",readonly:\"\"},domProps:{value:t.form_data.total_cutting},on:{input:function(a){a.target.composing||t.$set(t.form_data,\"total_cutting\",a.target.value)}}})]),e(\"th\",[e(\"input\",{directives:[{name:\"model\",rawName:\"v-model\",value:t.form_data.total_quantity,expression:\"form_data.total_quantity\"}],staticClass:\"ui-autocomplete-input\",attrs:{placeholder:\"Final Quantity\",type:\"text\",name:\"total_quantity\",readonly:\"\"},domProps:{value:t.form_data.total_quantity},on:{input:function(a){a.target.composing||t.$set(t.form_data,\"total_quantity\",a.target.value)}}})]),e(\"th\",[e(\"input\",{directives:[{name:\"model\",rawName:\"v-model\",value:t.form_data.total_price,expression:\"form_data.total_price\"}],staticClass:\"ui-autocomplete-input\",attrs:{placeholder:\"Price\",type:\"text\",name:\"total_price\",readonly:\"\"},domProps:{value:t.form_data.total_price},on:{input:function(a){a.target.composing||t.$set(t.form_data,\"total_price\",a.target.value)}}})])])],2)]),e(\"div\",{staticClass:\"o_thread_search_input mt-3\"},[e(\"span\",{staticStyle:{width:\"120px\"}},[t._v(\" Note : \")]),e(\"textarea\",{directives:[{name:\"model\",rawName:\"v-model\",value:t.form_data.note,expression:\"form_data.note\"}],staticClass:\"ui-autocomplete-input w-100 mx-1\",attrs:{placeholder:\"Note\",autocomplete:\"off\",rows:\"5\",name:\"note\"},domProps:{value:t.form_data.note},on:{input:function(a){a.target.composing||t.$set(t.form_data,\"note\",a.target.value)}}})])])])])])])])])],1),e(\"b-col\",{staticClass:\"my-3\",attrs:{lg:\"4\",xl:\"4\"}},[e(\"b-card\",{staticClass:\"card-scroll\",attrs:{\"header-bg-variant\":\"transparent\"}},[e(\"div\",{staticClass:\"ul-contact-detail__timeline\"},[e(\"div\",{staticClass:\"row\"},[e(\"div\",{staticClass:\"o_thread_composer  \"},[e(\"div\",{staticClass:\"o_composer_container my-2 row mx-0\"},[e(\"div\",{staticClass:\"col-md-1\"}),e(\"div\",{staticClass:\"col-md-12\"},[e(\"div\",{staticClass:\"o_thread_search_input mb-3\"},[e(\"span\",{staticStyle:{width:\"120px\"}},[t._v(\" Lot: \")]),e(\"input\",{staticClass:\"ui-autocomplete-input\",attrs:{type:\"text\",readonly:\"\"},domProps:{value:t.lot_id+\"/Lot\"}}),e(\"input\",{attrs:{type:\"hidden\",name:\"lot\"},domProps:{value:t.lot_id}})]),t.load_products?e(\"ProductFields\",{attrs:{product_id:t.product_id,readonly:!0},on:{productId:t.productId}}):t._e(),e(\"input\",{attrs:{type:\"hidden\",name:\"product\"},domProps:{value:t.product_id}}),e(\"div\",{staticClass:\"o_thread_search_input mb-3\"},[e(\"span\",{staticStyle:{width:\"120px\"}},[t._v(\" Product Price: \")]),e(\"input\",{staticClass:\"ui-autocomplete-input\",attrs:{type:\"text\",readonly:\"\"},domProps:{value:t.product_price}})])],1)])])]),e(\"hr\")])])],1)],1)],1)])},o=[],i=(e(\"4160\"),e(\"d3b7\"),e(\"159b\"),e(\"4dbf\")),n={metaInfo:{title:\"FPO - ICS\"},components:{ProductFields:i[\"a\"]},data:function(){return{form_data:{lot_detail:{},total_procure_qty:0,total_cutting:0,total_cutting_qc:0,total_quantity:0,total_price:0},id:null,load_products:!1,product_id:null,action:\"create\",lot_id:null,farmers:[],product_price:0}},mounted:function(){this.$root.current_section=\"purchase-manager\",this.lot_id=this.$route.params.id,this.checkLotPurchase()},methods:{checkLotPurchase:function(){var t=this,a=new Headers;a.append(\"Authorization\",\"Token \"+this.$root.token),fetch(this.api_url+\"/purchase/check_lot_purchase/\"+this.lot_id+\"/\",{method:\"get\",headers:a}).then((function(t){return t.json()})).then((function(a){a.success?(t.id=a.id,t.getForm()):t.selectLot()}))},getForm:function(){var t=this,a=new Headers;a.append(\"Authorization\",\"Token \"+this.$root.token),fetch(this.api_url+\"/purchase/farmer_purchase/\"+this.id+\"/\",{method:\"get\",headers:a}).then((function(t){return t.json()})).then((function(a){t.form_data=a,t.product_id=a.product,t.product_price=a.product_detail.price,t.load_products=!0,t.farmers=a.farmers,t.calcultion()}))},selectLot:function(){var t=this;this.load_products=!1;var a=new Headers;a.append(\"Authorization\",\"Token \"+this.$root.token),fetch(this.api_url+\"/qc/create_lots/\"+this.lot_id+\"/\",{method:\"get\",headers:a}).then((function(t){return t.json()})).then((function(a){t.form_data.lot_detail=a,t.product_id=a.product,t.product_price=a.product_detail.price,t.load_products=!0;var e=[];a.normal_procurements.forEach((function(t,a){t.farmer_lines.forEach((function(t){e.push(t)}))})),t.farmers=e,t.calcultion()}))},calcultion:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:\"\",a=this,e=0,r=0,o=0,i=0,n=0;this.farmers.forEach((function(s,c){if(\"cutting\"==t){var u=parseFloat(s.procure_qty)-parseFloat(s.cutting_mngr),l=parseFloat(s.cutting)/100*u;a.farmers[c].quantity=u-l}if(\"price\"!=t){var d=s.quantity;d||0==d||(d=s.procure_qty),a.farmers[c].price=a.product_price*parseFloat(d)}e+=parseFloat(s.procure_qty),r+=parseFloat(s.cutting_mngr),o+=parseFloat(s.cutting),i+=parseFloat(s.quantity),n+=parseFloat(s.price)})),this.form_data.total_procure_qty=e,this.form_data.total_cutting_mngr=r||0,this.form_data.total_cutting=o,this.form_data.total_quantity=i||0,this.form_data.total_price=n},productId:function(t){this.product_id=t,this.form_data.product=t},dataForm:function(){this.id?this.updateFormdata():this.createFormdata()},createFormdata:function(){var t=this,a=new FormData(this.$refs[\"dataForm\"]),e=new Headers;e.append(\"Authorization\",\"Token \"+this.$root.token),fetch(this.api_url+\"/purchase/farmer_purchase/\",{method:\"POST\",body:a,headers:e}).then((function(t){return t.json()})).then((function(a){a.id>0?t.showAlert(\"Saved Successfully!\"):t.showAlert(\"Something Wrong!\")}))},updateFormdata:function(){var t=this,a=new FormData(this.$refs[\"dataForm\"]),e=new Headers;e.append(\"Authorization\",\"Token \"+this.$root.token),fetch(this.api_url+\"/purchase/farmer_purchase/\"+this.id+\"/\",{method:\"PUT\",body:a,headers:e}).then((function(t){return t.json()})).then((function(a){a.id>0?t.showAlert(\"Updated Successfully!\"):t.showAlert(\"Something Wrong!\")}))}}},s=n,c=(e(\"970c\"),e(\"2877\")),u=Object(c[\"a\"])(s,r,o,!1,null,null,null);a[\"default\"]=u.exports}}]);","extractedComments":[]}